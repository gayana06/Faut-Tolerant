<?xml version="1.0" encoding="utf-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="Docutils 0.7: http://docutils.sourceforge.net/" />
<title></title>
<style type="text/css">

/*
:Author: David Goodger (goodger@python.org)
:Id: $Id: html4css1.css 6253 2010-03-02 00:24:53Z milde $
:Copyright: This stylesheet has been placed in the public domain.

Default cascading style sheet for the HTML output of Docutils.

See http://docutils.sf.net/docs/howto/html-stylesheets.html for how to
customize this style sheet.
*/

/* used to remove borders from tables and images */
.borderless, table.borderless td, table.borderless th {
  border: 0 }

table.borderless td, table.borderless th {
  /* Override padding for "table.docutils td" with "! important".
     The right padding separates the table cells. */
  padding: 0 0.5em 0 0 ! important }

.first {
  /* Override more specific margin styles with "! important". */
  margin-top: 0 ! important }

.last, .with-subtitle {
  margin-bottom: 0 ! important }

.hidden {
  display: none }

a.toc-backref {
  text-decoration: none ;
  color: black }

blockquote.epigraph {
  margin: 2em 5em ; }

dl.docutils dd {
  margin-bottom: 0.5em }

/* Uncomment (and remove this text!) to get bold-faced definition list terms
dl.docutils dt {
  font-weight: bold }
*/

div.abstract {
  margin: 2em 5em }

div.abstract p.topic-title {
  font-weight: bold ;
  text-align: center }

div.admonition, div.attention, div.caution, div.danger, div.error,
div.hint, div.important, div.note, div.tip, div.warning {
  margin: 2em ;
  border: medium outset ;
  padding: 1em }

div.admonition p.admonition-title, div.hint p.admonition-title,
div.important p.admonition-title, div.note p.admonition-title,
div.tip p.admonition-title {
  font-weight: bold ;
  font-family: sans-serif }

div.attention p.admonition-title, div.caution p.admonition-title,
div.danger p.admonition-title, div.error p.admonition-title,
div.warning p.admonition-title {
  color: red ;
  font-weight: bold ;
  font-family: sans-serif }

/* Uncomment (and remove this text!) to get reduced vertical space in
   compound paragraphs.
div.compound .compound-first, div.compound .compound-middle {
  margin-bottom: 0.5em }

div.compound .compound-last, div.compound .compound-middle {
  margin-top: 0.5em }
*/

div.dedication {
  margin: 2em 5em ;
  text-align: center ;
  font-style: italic }

div.dedication p.topic-title {
  font-weight: bold ;
  font-style: normal }

div.figure {
  margin-left: 2em ;
  margin-right: 2em }

div.footer, div.header {
  clear: both;
  font-size: smaller }

div.line-block {
  display: block ;
  margin-top: 1em ;
  margin-bottom: 1em }

div.line-block div.line-block {
  margin-top: 0 ;
  margin-bottom: 0 ;
  margin-left: 1.5em }

div.sidebar {
  margin: 0 0 0.5em 1em ;
  border: medium outset ;
  padding: 1em ;
  background-color: #ffffee ;
  width: 40% ;
  float: right ;
  clear: right }

div.sidebar p.rubric {
  font-family: sans-serif ;
  font-size: medium }

div.system-messages {
  margin: 5em }

div.system-messages h1 {
  color: red }

div.system-message {
  border: medium outset ;
  padding: 1em }

div.system-message p.system-message-title {
  color: red ;
  font-weight: bold }

div.topic {
  margin: 2em }

h1.section-subtitle, h2.section-subtitle, h3.section-subtitle,
h4.section-subtitle, h5.section-subtitle, h6.section-subtitle {
  margin-top: 0.4em }

h1.title {
  text-align: center }

h2.subtitle {
  text-align: center }

hr.docutils {
  width: 75% }

img.align-left, .figure.align-left, object.align-left {
  clear: left ;
  float: left ;
  margin-right: 1em }

img.align-right, .figure.align-right, object.align-right {
  clear: right ;
  float: right ;
  margin-left: 1em }

img.align-center, .figure.align-center, object.align-center {
  display: block;
  margin-left: auto;
  margin-right: auto;
}

.align-left {
  text-align: left }

.align-center {
  clear: both ;
  text-align: center }

.align-right {
  text-align: right }

/* reset inner alignment in figures */
div.align-right {
  text-align: left }

/* div.align-center * { */
/*   text-align: left } */

ol.simple, ul.simple {
  margin-bottom: 1em }

ol.arabic {
  list-style: decimal }

ol.loweralpha {
  list-style: lower-alpha }

ol.upperalpha {
  list-style: upper-alpha }

ol.lowerroman {
  list-style: lower-roman }

ol.upperroman {
  list-style: upper-roman }

p.attribution {
  text-align: right ;
  margin-left: 50% }

p.caption {
  font-style: italic }

p.credits {
  font-style: italic ;
  font-size: smaller }

p.label {
  white-space: nowrap }

p.rubric {
  font-weight: bold ;
  font-size: larger ;
  color: maroon ;
  text-align: center }

p.sidebar-title {
  font-family: sans-serif ;
  font-weight: bold ;
  font-size: larger }

p.sidebar-subtitle {
  font-family: sans-serif ;
  font-weight: bold }

p.topic-title {
  font-weight: bold }

pre.address {
  margin-bottom: 0 ;
  margin-top: 0 ;
  font: inherit }

pre.literal-block, pre.doctest-block {
  margin-left: 2em ;
  margin-right: 2em }

span.classifier {
  font-family: sans-serif ;
  font-style: oblique }

span.classifier-delimiter {
  font-family: sans-serif ;
  font-weight: bold }

span.interpreted {
  font-family: sans-serif }

span.option {
  white-space: nowrap }

span.pre {
  white-space: pre }

span.problematic {
  color: red }

span.section-subtitle {
  /* font-size relative to parent (h1..h6 element) */
  font-size: 80% }

table.citation {
  border-left: solid 1px gray;
  margin-left: 1px }

table.docinfo {
  margin: 2em 4em }

table.docutils {
  margin-top: 0.5em ;
  margin-bottom: 0.5em }

table.footnote {
  border-left: solid 1px black;
  margin-left: 1px }

table.docutils td, table.docutils th,
table.docinfo td, table.docinfo th {
  padding-left: 0.5em ;
  padding-right: 0.5em ;
  vertical-align: top }

table.docutils th.field-name, table.docinfo th.docinfo-name {
  font-weight: bold ;
  text-align: left ;
  white-space: nowrap ;
  padding-left: 0 }

h1 tt.docutils, h2 tt.docutils, h3 tt.docutils,
h4 tt.docutils, h5 tt.docutils, h6 tt.docutils {
  font-size: 100% }

ul.auto-toc {
  list-style-type: none }

</style>
</head>
<body>
<div class="document">


<div class="contents topic" id="table-of-contents">
<p class="topic-title first">Table of Contents</p>
<ul class="simple">
<li><a class="reference internal" href="#summary" id="id1">Summary</a></li>
<li><a class="reference internal" href="#objectives" id="id2">Objectives</a></li>
<li><a class="reference internal" href="#overview" id="id3">Overview</a></li>
<li><a class="reference internal" href="#running" id="id4">Running</a><ul>
<li><a class="reference internal" href="#part-1-guide-to-doing-the-all-ack-uniform-reliable-broadcast-protocol" id="id5">Part 1 - Guide to doing the All-Ack Uniform Reliable Broadcast Protocol</a></li>
<li><a class="reference internal" href="#part-2-implementing-the-majority-ack-uniform-broadcast-protocol" id="id6">Part 2 - Implementing the Majority Ack Uniform Broadcast protocol</a></li>
</ul>
</li>
</ul>
</div>
<div class="section" id="summary">
<h1><a class="toc-backref" href="#id1">Summary</a></h1>
<p>In this lesson we will implement the All-Ack and Majority-Ack Uniform Reliable Broadcast protocol.</p>
</div>
<div class="section" id="objectives">
<h1><a class="toc-backref" href="#id2">Objectives</a></h1>
<p>The forth laboratory has the following objectives:</p>
<pre class="literal-block">
* Implement a Uniform Reliable Broadcast protocol. The **All-Ack** uniform reliable broadcast protocol
* Introduction to the concept of majority
* Implement the **Majority Ack** Uniform Reliable broadcast protocol.
</pre>
</div>
<div class="section" id="overview">
<h1><a class="toc-backref" href="#id3">Overview</a></h1>
<p>The QoS property indicates which is QoS used for the process.</p>
<p>In the last lesson we have implemented the best effort broadcast, as depicted in the next image.</p>
<div class="figure align-center">
<img alt="alternate text" src="images/beffortBroadcast.png" style="height: 200px;" />
</div>
<p>And the lazy reliable broadcast:</p>
<div class="figure align-center">
<img alt="alternate text" src="https://dspace.ist.utl.pt/bitstream/2295/1079000/1/lazyRB.png" style="height: 200px;" />
</div>
<p>In this lesson we are going to implement the <strong>All Acknowledge</strong> Uniform Reliable Broadcast.</p>
<div class="figure align-center">
<img alt="alternate text" src="https://dspace.ist.utl.pt/bitstream/2295/1078998/1/allackURB.png" style="height: 200px;" />
</div>
<p>And the Majority Acknowledge Uniform Reliable Broadcast.</p>
<div class="figure align-center">
<img alt="alternate text" src="https://dspace.ist.utl.pt/bitstream/2295/1078999/1/majackURB.png" style="height: 200px;" />
</div>
</div>
<div class="section" id="running">
<h1><a class="toc-backref" href="#id4">Running</a></h1>
<div class="section" id="part-1-guide-to-doing-the-all-ack-uniform-reliable-broadcast-protocol">
<h2><a class="toc-backref" href="#id5">Part 1 - Guide to doing the All-Ack Uniform Reliable Broadcast Protocol</a></h2>
<ol class="arabic" start="0">
<li><p class="first">First read the All-Ack Uniform reliable broadcast protocol in page 82-83 of the book.</p>
</li>
<li><p class="first">Files which will be created are the allAckURB/AllAckURBLayer.java and allAckURB/AllAckURBSession.java.</p>
</li>
<li><p class="first">In the layer file specify, what events the protocol:</p>
<pre class="literal-block">
* Provides - Does it create a new type of event?
* Requires - Which events are essential for its functioning? This is always a subset of accepted events.
* Accepts  - Which events the protocol will receive?
</pre>
</li>
<li><p class="first">In the session file:</p>
<ol class="arabic">
<li><p class="first">Think about the variables the protocol needs. (look at the init event in the algorithm 3.4 of the book).</p>
<ol class="arabic simple">
<li>The delivered variable is a list of delivered messages (note that messages can be uniquily identified by MessageID class).</li>
<li>The pending variable is a list of pending messages.</li>
<li>The <em>correct</em> variable is a list of correct processes.</li>
<li>For the ack array, look at the MessageEntry class. The ack array indexed by message id. Each position of the array has the list of the processes which you have received that message.</li>
</ol>
</li>
<li><p class="first">Handle each event the protocol was declared to receive:</p>
<ol class="arabic simple">
<li>When the channel is initiated initialize the variables as on the init event. (minus the <em>correct</em> variable)</li>
<li>When a process init is received, store the process list (all nodes available in the world) on the <em>correct</em> variable.</li>
<li>When receiving a sendable message from an upper layer, insert a unique message ID to the message. (look at the MessageID class). Store the message in the pending message list. Then broadcast the message (do not forget to include the MessageID with event.getMessage().pushObject()).</li>
<li>When receiving a sendable message from a lower layer:</li>
</ol>
<blockquote>
<ol class="arabic simple">
<li>Get the message id of the message.</li>
<li>Store the message (not the event itself but a clone) in the ack array. In that position, insert the process id from the process which sent you the message.</li>
<li>If the message is not in the pending variable, insert it in the pending variable and trigger a best effort broadcast of the message (the original, not the clone).</li>
</ol>
</blockquote>
<ol class="arabic simple" start="5">
<li>When receiving a crash event from a lower layer, simply remove the process from the <em>correct</em> process list.</li>
<li>Whenever possible (through polling or whenever you receive <strong>any</strong> event) check if you can deliver the a message to the upper layer. If you deliver the message, do not forget to add to the delivered variable to avoid duplication of messages.</li>
</ol>
</li>
</ol>
</li>
<li><p class="first">Create the new QoS in the tfsd/SampleAppl.java class.</p>
</li>
<li><p class="first">Create the new command (<strong>aab</strong>) to use that QoS.</p>
</li>
</ol>
</div>
<div class="section" id="part-2-implementing-the-majority-ack-uniform-broadcast-protocol">
<h2><a class="toc-backref" href="#id6">Part 2 - Implementing the Majority Ack Uniform Broadcast protocol</a></h2>
<ol class="arabic simple" start="0">
<li>First read the All-Ack Uniform reliable broadcast protocol in page 84-85 of the book.</li>
<li>Does the Majority Ack Uniform Broadcast protocol require the Perfect Failure Detecture? Treat accordingly.</li>
<li>Change the candeliver condition.</li>
</ol>
</div>
</div>
</div>
</body>
</html>
